<<<<<<< HEAD
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Âπ∏Á¶èÊüë‰ªîÂ∫ó</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        /* --- GAS Mobile Fix Start --- */
        html, body { 
            position: fixed; 
            top: 0; left: 0; right: 0; bottom: 0;
            width: 100%; height: 100%;
            margin: 0; padding: 0; 
            background-color: #2d3748; 
            font-family: 'Noto Sans TC', sans-serif; 
            overflow: hidden; 
            overscroll-behavior: none; 
        }

        #mobile-container {
            width: 100%; 
            height: 100%; 
            max-width: 480px;
            margin: 0 auto; 
            background: #000; 
            position: relative; 
            overflow: hidden;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
        }
        /* --- GAS Mobile Fix End --- */

        /* ËÉåÊôØÂ±§ */
        #bg-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-size: cover; background-position: center;
            transition: opacity 0.5s ease;
            background-color: #333; z-index: 1;
        }

        /* ÈõôÁ∑©Ë°ùËßíËâ≤Â±§ */
        #char-container {
            position: absolute; bottom: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 10;
        }
        .char-img {
            position: absolute; bottom: 0; left: 50%; transform: translateX(-50%);
            max-height: 85%; width: auto; max-width: 95%; 
            opacity: 0; 
            filter: drop-shadow(0 5px 15px rgba(0,0,0,0.4));
            transition: opacity 0.4s ease-in-out; 
        }
        .char-visible { opacity: 1; }
        .object-mode { bottom: 25% !important; max-height: 45% !important; }

        /* HUD */
        #top-hud {
            position: absolute; top: 0; left: 0; width: 100%; padding: 15px;
            background: linear-gradient(to bottom, rgba(0,0,0,0.8), transparent);
            color: white; z-index: 20; display: flex; justify-content: space-between;
            pointer-events: none;
        }
        .status-pill {
            background: rgba(255,255,255,0.15); backdrop-filter: blur(5px);
            padding: 8px 16px; border-radius: 25px; font-size: 16px; font-weight: bold;
            border: 1px solid rgba(255,255,255,0.2); display: flex; align-items: center; gap: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        /* Èü≥Ê®ÇÈñãÈóú */
        #music-toggle {
            position: absolute; top: 15px; right: 15px; z-index: 50;
            width: 40px; height: 40px; border-radius: 50%;
            background: rgba(0,0,0,0.6); border: 2px solid rgba(255,255,255,0.5);
            color: white; font-size: 18px; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            pointer-events: auto; transition: all 0.2s;
        }
        #music-toggle:active { transform: scale(0.9); background: rgba(0,0,0,0.8); }
        .music-off { color: #aaa; border-color: #555 !important; }

        /* Â∞çË©±Ê°Ü */
        #dialog-area {
            position: absolute; bottom: 0; left: 0; width: 100%; height: 38%;
            background: linear-gradient(to top, rgba(0,0,0,0.95), rgba(0,0,0,0.85) 85%, transparent);
            padding: 25px; padding-top: 45px; color: white; z-index: 30;
            display: flex; flex-direction: column; cursor: pointer;
        }
        #speaker-box {
            align-self: flex-start; background: #f6ad55; color: #2d3748;
            padding: 6px 18px; border-radius: 8px; font-weight: bold; font-size: 20px; margin-bottom: 12px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3); transform: translateY(-5px);
            display: flex; align-items: center; gap: 10px;
        }
        .read-btn {
            background: rgba(255,255,255,0.3); color: #2d3748; border-radius: 50%;
            width: 24px; height: 24px; display: flex; align-items: center; justify-content: center;
            font-size: 14px; cursor: pointer;
        }
        #dialog-text { 
            font-size: 22px; line-height: 1.6; flex: 1; overflow-y: auto; 
            text-shadow: 0 1px 2px rgba(0,0,0,0.8); white-space: pre-wrap; word-break: break-all;
        }
        .next-arrow { position: absolute; bottom: 25px; right: 25px; color: #f6ad55; animation: bounce 1s infinite; font-size: 28px; }

        /* ‰∫íÂãïÂ±§ */
        #interaction-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); backdrop-filter: blur(10px);
            z-index: 100; display: none;
            flex-direction: column; justify-content: center; align-items: center; padding: 20px;
        }
        #interaction-title {
            color: white; font-size: 24px; font-weight: bold; text-align: center; margin-bottom: 25px;
            background: rgba(255,255,255,0.1); padding: 15px; border-radius: 12px; width: 100%;
            border: 1px solid rgba(255,255,255,0.2); display: flex; justify-content: space-between; align-items: center;
        }
        .title-speak-btn {
            background: rgba(255,255,255,0.2); width: 32px; height: 32px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; cursor: pointer;
        }

        /* ÈÅ∏ÊìáÊåâÈàï */
        .choice-btn {
            background: white; color: #2d3748; width: 100%; padding: 20px; margin-bottom: 16px;
            border-radius: 16px; border: none; font-size: 20px; font-weight: bold;
            box-shadow: 0 4px 0 #cbd5e0; transition: transform 0.1s;
            display: flex; justify-content: space-between; align-items: center; cursor: pointer;
        }
        .choice-btn:active { transform: translateY(4px); box-shadow: none; background: #e2e8f0; }
        .choice-speak-icon {
            background: #e2e8f0; width: 36px; height: 36px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; color: #4a5568;
            margin-right: 15px; z-index: 10;
        }

        /* Ëº∏ÂÖ•‰ªãÈù¢ */
        .input-group { 
            display: flex; gap: 4px; 
            margin-bottom: 25px; width: 100%; justify-content: center; 
        }
        .custom-select {
            padding: 10px 0; 
            font-size: 18px; 
            border-radius: 10px; border: 3px solid #f6ad55;
            background: #fff; color: #2d3748; font-weight: bold; text-align: center; 
            flex: 1; 
            width: 0; 
            min-width: 0; 
        }
        .confirm-btn {
            background: #48bb78; color: white; padding: 18px 40px; border-radius: 50px;
            font-size: 24px; font-weight: bold; border: none; cursor: pointer;
            box-shadow: 0 6px 0 #2f855a; width: 100%; margin-top: 15px;
        }
        .confirm-btn:active { transform: translateY(4px); box-shadow: none; }

        /* Numpad */
        #numpad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; width: 100%; margin-bottom: 20px; }
        .num-btn {
            background: rgba(255,255,255,0.15); color: white; border: 2px solid rgba(255,255,255,0.3);
            padding: 20px; font-size: 26px; font-weight: bold; border-radius: 12px; cursor: pointer;
        }
        .num-btn:active { background: rgba(255,255,255,0.4); transform: scale(0.95); }
        #numpad-display {
            width: 100%; background: #fff; color: #2d3748; font-size: 40px; font-weight: bold;
            text-align: center; padding: 15px; border-radius: 12px; margin-bottom: 25px;
            border: 4px solid #f6ad55; letter-spacing: 3px; height: 80px; display: flex; align-items: center; justify-content: center;
        }

        /* Time Picker */
        .time-picker-container {
            display: flex; flex-direction: column; align-items: center; width: 100%;
            background: white; border-radius: 20px; padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .ampm-toggle {
            display: flex; background: #e2e8f0; border-radius: 50px; padding: 5px; margin-bottom: 20px; width: 100%;
        }
        .ampm-btn {
            flex: 1; padding: 10px; border-radius: 40px; border: none; font-size: 20px; font-weight: bold;
            cursor: pointer; background: transparent; color: #718096; transition: all 0.2s;
        }
        .ampm-btn.active { background: #3b82f6; color: white; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .hour-selector {
            display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; width: 100%;
        }
        .hour-btn {
            background: #f7fafc; border: 2px solid #e2e8f0; border-radius: 12px;
            padding: 15px 0; font-size: 24px; font-weight: bold; color: #2d3748;
            cursor: pointer; transition: all 0.2s;
        }
        .hour-btn.selected {
            border-color: #f6ad55; background: #fffaf0; color: #ed8936; box-shadow: 0 0 0 2px #f6ad55;
        }

        /* Intro & Report */
        #intro-overlay, #report-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 200; backdrop-filter: blur(5px);
            display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 40px; text-align: center; color: white;
        }
        .intro-title { font-size: 40px; font-weight: bold; color: #f6ad55; margin-bottom: 25px; }
        .report-card {
            background: #fff; width: 100%; padding: 35px 25px; border-radius: 25px;
            box-shadow: 0 10px 50px rgba(0,0,0,0.8); text-align: center; color: #2d3748;
        }
        .stamp {
            border: 5px solid #e53e3e; color: #e53e3e; border-radius: 15px;
            padding: 10px 25px; font-size: 32px; font-weight: bold;
            transform: rotate(-5deg); margin: 30px auto; display: inline-block;
        }
        #start-btn {
            background: linear-gradient(135deg, #f6ad55, #ed8936); color: #fff; border: none; 
            padding: 18px 70px; border-radius: 50px; font-size: 24px; font-weight: bold; 
            cursor: pointer; box-shadow: 0 6px 20px rgba(237, 137, 54, 0.4);
            transition: all 0.3s; width: 80%; text-align: center;
        }
        #start-btn:disabled { background: #718096; cursor: wait; animation: none; box-shadow: none; opacity: 0.8; }
        .pulse { animation: pulse 2s infinite; }

        /* Key Item */
        #key-item {
            position: absolute; top: 60%; left: 70%; width: 100px; display: none; 
            z-index: 15; filter: drop-shadow(0 0 10px gold); cursor: pointer;
            animation: floatKey 2s infinite ease-in-out;
        }
        
        @keyframes floatKey { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(5px); } }
    </style>
</head>
<body>

    <div id="mobile-container">
        <!-- Èü≥Ê®ÇÔºö‰øÆÊ≠£ ID ‰∏¶ÊõøÊèõÁÇ∫Ê≠£Á¢∫ÈÄ£Áµê -->
        <audio id="bgMusic" loop preload="auto">
            <source src="https://tunes.stocktune.com/public/8/7/e/87e007c3-7502-426c-8e14-f2a014c9c66f/whispers-of-forgotten-memories-stocktune.mp3" type="audio/mpeg">
        </audio>

        <div id="music-toggle" onclick="toggleMusic()">
            <i class="fas fa-volume-up"></i>
        </div>

        <div id="bg-layer"></div>
        
        <div id="char-container">
            <img id="char-1" class="char-img" alt="Char1">
            <img id="char-2" class="char-img" alt="Char2">
        </div>
        
        <img id="key-item" src="" alt="Key">
        
        <div id="top-hud">
            <div class="status-pill"><i class="fas fa-clock"></i> <span id="game-time">08:00</span></div>
            <div style="flex:1;"></div>
            <div class="status-pill" style="margin-right: 50px;"><i class="fas fa-coins"></i> ÁáüÊî∂: <span id="game-money">0</span></div>
        </div>
        
        <div id="dialog-area" onclick="advanceStory()">
            <div id="speaker-box">
                <span id="speaker-name">...</span>
                <div class="read-btn" onclick="event.stopPropagation(); replayVoice()"><i class="fas fa-volume-up"></i></div>
            </div>
            <div id="dialog-text">...</div>
            <div class="next-arrow"><i class="fas fa-caret-down"></i></div>
        </div>
        
        <div id="interaction-overlay">
            <div id="interaction-title">
                <span id="title-text">Ë´ãÈÅ∏Êìá</span>
                <div class="title-speak-btn" onclick="speakTitle()"><i class="fas fa-volume-up"></i></div>
            </div>
            <div id="interaction-content" style="width:100%"></div>
        </div>

        <div id="intro-overlay">
            <div class="intro-title">Âπ∏Á¶èÊüë‰ªîÂ∫ó</div>
            <div style="font-size:20px; line-height:1.8; color:#e2e8f0; margin-bottom:40px;">
                Ê≠°ËøéÂÖâËá®ÔºÅ<br>‰ªäÂ§©ÊÇ®Â∞áÂåñË∫´ÁÇ∫<b>„Äå‰∏ÄÊó•Â∫óÈï∑„Äç</b>Ôºå<br>Ë´ãÁôºÊèÆÊÇ®ÁöÑÊô∫ÊÖßËàáÁ∂ìÈ©óÔºå<br>ËôïÁêÜÊüë‰ªîÂ∫óÁöÑÂ§ßÂ∞è‰∫ãÂêßÔºÅ
            </div>
            <button id="start-btn" onclick="startGame()" disabled>
                <i class="fas fa-spinner fa-spin"></i> ÈÅäÊà≤ËºâÂÖ•‰∏≠...
            </button>
        </div>
        
        <div id="report-overlay" style="display:none;">
            <div class="report-card">
                <h2 style="margin:0;">üìÖ Êú¨Êó•ÁáüÈÅãÊó•Â†±</h2>
                <div style="font-size:16px; color:#718096; margin-bottom:20px;">Âè∞ÂåóÁ∏ΩÂ∫ó</div>
                <div id="final-stamp" class="stamp">...</div>
                <div style="display:flex; justify-content:space-between; border-bottom:1px dashed #ccc; padding:15px 0;">
                    <span>ÁáüÈÅãÁ©çÂàÜ</span><span id="report-money" style="font-weight:bold; color:#38a169; font-size:22px;">$0</span>
                </div>
                <div style="display:flex; justify-content:space-between; border-bottom:1px dashed #ccc; padding:15px 0;">
                    <span>Â∞àÊ≥®ÂäõË©ïÁ¥ö</span><span id="report-risk" style="font-weight:bold; font-size:22px;">S Á¥ö</span>
                </div>
                <p id="report-advice" style="font-size:18px; margin-top:25px; text-align:left; background:#f7fafc; padding:20px; border-radius:15px; line-height:1.6;">...</p>
            </div>
            <button onclick="location.reload()" style="background:#4fd1c5; color:white; border:none; padding:18px 50px; border-radius:50px; font-size:22px; font-weight:bold; margin-top:30px; cursor:pointer;">ÊòéÊó•ÁπºÁ∫åÁáüÊ•≠</button>
        </div>
    </div>

    <script>
        // ================= JS Fix for GAS =================
        function resizeApp() {
            const vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
            document.getElementById('mobile-container').style.height = `${window.innerHeight}px`;
        }
        window.addEventListener('resize', resizeApp);
        
        // ================= Á¥†Êùê (‰øÆÊ≠£ÈÄ£Áµê) =================
        const ASSETS = {
            bg_morning: "https://i.ibb.co/kVFN53b9/store-day.jpg",
            bg_noon: "https://i.ibb.co/kVFN53b9/store-day.jpg",
            bg_evening: "https://i.ibb.co/TqMpjG6D/store-dusk.jpg",
            bg_night: "https://i.ibb.co/WNzmf9SQ/store-night.jpg",
            bg_desktop: "https://i.ibb.co/xKSQWsNM/desktop.jpg",
            char_oldman: "https://i.ibb.co/v6PmHDZY/wang.png",
            char_delivery: "https://i.ibb.co/9mDg6DbQ/deliveryboy.png",
            char_customer: "https://i.ibb.co/sJJzGsbZ/mrschen.png", 
            char_tv: "https://i.ibb.co/GfTGhprQ/tv.png",
            char_keys: "https://i.ibb.co/6hhTndN/key.png",
            // ‰ΩøÁî®ÊúâÊïàÈÄ£ÁµêÊõøÊèõ placeholder ‰ª•ÈÅøÂÖç 404 ÈåØË™§
            char_phone: "https://i.ibb.co/6hhTndN/key.png", // Êö´ÊôÇ‰ΩøÁî® keyÔºåÂØ¶ÈöõÊáâÊõøÊèõÁÇ∫ÈõªË©±Âúñ
            char_clock: "https://i.ibb.co/kVFN53b9/store-day.jpg" // Êö´ÊôÇ‰ΩøÁî®ËÉåÊôØÂúñÈÅøÂÖçÁ¥ÖÂ≠ó
        };

        const VOICE_PROFILES = {
            "Â∫óÈï∑": { pitch: 1.0, rate: 1.0 },
            "ÊóÅÁôΩ": { pitch: 1.0, rate: 1.1 },
            "ËÇâË≤©Â∞èÂäâ": { pitch: 1.5, rate: 1.4 }, 
            "Á±≥Â∫óÈòøÂº∑": { pitch: 0.7, rate: 1.2 },
            "ËÄÅÁéã": { pitch: 0.6, rate: 0.8 }, 
            "Èô≥Â§™Â§™": { pitch: 1.4, rate: 1.1 },
            "ÈõªË©±": { pitch: 1.1, rate: 1.1 }
        };

        const SCRIPT = [
            { type: "scene", bg: "bg_morning", time: "08:00" },
            { type: "talk", speaker: "Â∫óÈï∑", text: "Êó©ÂÆâÔºÅÂèàÊòØÂÖÖÊªøÊ¥ªÂäõÁöÑ‰∏ÄÂ§©„ÄÇ", char: null },
            { type: "talk", speaker: "Â∫óÈï∑", text: "È¶ñÂÖàË¶ÅÊääÊó•ÊõÜÊíïÂà∞‰ªäÂ§©... Âí¶Ôºü‰ªäÂ§©ÊòØÂπæËôüÔºü", char: "char_clock" },
            { type: "date_input", text: "Ë´ãÈÅ∏Êìá‰ªäÊó•ÁöÑÊ≠£Á¢∫Êó•ÊúüÔºö", correct: { money: 100, s: 0 }, wrong: { money: 0, s: 1 }, char: "char_clock" },
            { type: "talk", speaker: "Â∫óÈï∑", text: "‰πñ‰πñÈÄ≤Ë≤®‰∫ÜÔºå‰ΩÜÂ†ÜÂæó‰∫Ç‰∏ÉÂÖ´Á≥ü„ÄÇ‰ª•ÂâçÊàëÊúÄÂñúÊ≠°Êì∫Êï¥ÈΩä‰∫Ü...", char: null },
            { type: "choice", text: "ÊÇ®ÁèæÂú®ÁöÑÊÉ≥Ê≥ïÊòØÔºü", choices: [{ t: "ÂÜçÁ¥Ø‰πüË¶ÅÂ•ΩÂ•ΩÊï¥ÁêÜ‰∏Ä‰∏ãÔºåÁîüÊÑèÊâçÊúÉÂ•Ω", s: 0, money: 200 }, { t: "Â•ΩÁ¥ØÂñîÔºåÂÅ∑Êá∂‰∏Ä‰∏ãÔºåÁîüÊÑè‰∏çÊúÉÂ∑ÆÂ§öÂ∞ë", s: 1, money: 0 }], char: null },
            { type: "talk", speaker: "ÊóÅÁôΩ", text: "(Èà¥Èà¥Èà¥‚Äî‚Äî Á¥ÖËâ≤ÈõªË©±Èüø‰∫Ü)", char: "char_phone" },
            { type: "talk", speaker: "ËÇâË≤©Â∞èÂäâ", text: "„ÄéËÄÅÈóÜÂ•ΩÔºåÊàëÊòØËÇâË≤©Â∞èÂäâÔºåÊàëÂÄëÊúâÈÄ≤Âè£È´òÁ¥öÊæ≥Ê¥≤ÁâõËÇâË∂Ö‰æøÂÆúÔºÅ„Äè", char: "char_phone" },
            { type: "talk", speaker: "ËÇâË≤©Â∞èÂäâ", text: "„ÄéÂ§ñÈù¢1Êñ§Ë¶Å‰∏ÄÂçÉÂÖÉÔºåÊàëÈÄôÈÇäÂè™Ë¶ÅË≥£‰∏ÄÁôæÂÖÉÔºåÊÇ®ÂÜçË≥£‰∏ÄÊñ§‰∫îÁôæÂÖÉÁµ¶ÂÆ¢‰∫∫ÈÉΩÈÇÑË≥∫Èå¢ÔºÅ„Äè", char: "char_phone" },
            { type: "talk", speaker: "ËÇâË≤©Â∞èÂäâ", text: "„ÄéË¶Å‰∏çË¶ÅÂÖàÂåØÈå¢Áµ¶ÊàëË≤∑ÂÄã100Êñ§ÔºåÊàëÂÜçÈ¶¨‰∏äÂØÑÁµ¶ÊÇ®Ôºü„Äè", char: "char_phone" },
            { type: "choice", text: "ÊÇ®ÁöÑÂèçÊáâÊòØÔºü", choices: [{ t: "Â•ΩÂÉèÂæàÂàíÁÆóÔºÅÈ¶¨‰∏äÂåØÊ¨æ„ÄÇ", s: 1, money: -500, reaction: {text: "Â∫óÈï∑: Â•ΩÔºåÂåØÈÅéÂéª‰∫ÜÔºÅÊúüÂæÖÁâõËÇâ... ‰∏çÈÅéÂøÉË£°ÊÄéÈ∫ºÊÄ™ÊÄ™ÁöÑÔºü", speaker: "Â∫óÈï∑"} }, { t: "ËÅΩËµ∑‰æÜÊòØË©êÈ®ôÔºåÁõ¥Êé•ÊéõÊñ∑„ÄÇ", s: 0, money: 500 }], char: "char_phone" },
            { type: "talk", speaker: "Â∫óÈï∑", text: "Âëº... ÁúüÁöÑË¶ÅÂ∞èÂøÉ„ÄÇ", char: null },
            { type: "talk", speaker: "ÊóÅÁôΩ", text: "(Èà¥Èà¥Èà¥‚Äî‚Äî ÈõªË©±ÂèàÈüø‰∫Ü)", char: "char_phone" },
            { type: "talk", speaker: "Á±≥Â∫óÈòøÂº∑", text: "„ÄéÂñÇÔºüËÄÅÈóÜÂñîÔºåÊàëÊòØÁ±≥Â∫óÈòøÂº∑Âï¶ÔºÅ‰∏ãÂçà 4 ÈªûÊàëÊúÉÈÅéÂéªÈÄÅË≤®ÔºåÂÖàË∑ü‰Ω†Ë¨õ‰∏ÄËÅ≤ÔºÅ„Äè", char: "char_phone" },
            { type: "talk", speaker: "Â∫óÈï∑", text: "Â•ΩÔºå‰∏ãÂçà 4 ÈªûÔºåÊàëË®ò‰Ωè‰∫Ü„ÄÇ", char: null },
            { type: "scene", bg: "bg_morning", time: "10:00" },
            { type: "talk", speaker: "ÊóÅÁôΩ", text: "(ËÄÅÁéãÊêñËëóÊâáÂ≠êËµ∞‰∫ÜÈÄ≤‰æÜ)", char: "char_oldman" }, 
            { type: "talk", speaker: "ËÄÅÁéã", text: "Â∫óÈï∑Êó©ÂïäÔºÅÊò®Â§©Â§©Ê∞£Â•ΩÔºåÊàëÂéªÂÖ¨ÂúíÊâì‰∫Ü‰∏ÄÂ•óÂ§™Ê•µÊã≥ÂñîÔºÅ", char: "char_oldman" },
            { type: "talk", speaker: "Â∫óÈï∑", text: "Â§™Ê•µÊã≥‰∏çÈåØÂñîÔºåÂ∞çË∫´È´îÂ•Ω„ÄÇ", char: "char_oldman" },
            { type: "talk", speaker: "ËÄÅÁéã", text: "ÂòøÂïäÔºåÈÇÑÈÅáÂà∞Èô≥Â™ΩÂ™ΩÔºåËÅä‰∫ÜÂæàÂ§ö„ÄÇ", char: "char_oldman" },
            { type: "choice", text: "ÊÇ®ÊÉ≥Êé•ËëóÂïèËÄÅÁéã‰ªÄÈ∫ºÔºü", choices: [{ t: "Êò®Â§©‰Ω†ÂéªÂì™Ë£°ÈÅãÂãïÂïäÔºü", s: 1, money: 0 }, { t: "ÈÇ£ÂÖ¨ÂúíÊúâ‰ªÄÈ∫ºÊñ∞ËÆäÂåñÂóéÔºü", s: 0, money: 100 }], char: "char_oldman" }, 
            { type: "talk", speaker: "ËÄÅÁéã", text: "ÂìàÂìàÔºåÂ∞±ÈÇ£Ê®£Âï¶„ÄÇÈÇ£ÊàëÂÖàËµ∞‰∫ÜÔºåÊé∞Êé∞ÔºÅ", char: "char_oldman" },
            { type: "talk", speaker: "ÊóÅÁôΩ", text: "(ËÄÅÁéãÊèÆÊèÆÊâãÈõ¢Èñã‰∫Ü)", char: null }, 
            { type: "scene", bg: "bg_noon", time: "12:00" },
            { type: "talk", speaker: "Â∫óÈï∑", text: "‰∏≠Âçà‰ºëÊÅØÁúã‰∏Ä‰∏ãÊñ∞ËÅûÂ•Ω‰∫Ü... ÂìéÂëÄÔºÅ", char: "char_tv", object: true },
            { type: "talk", speaker: "ÊóÅÁôΩ", text: "(ÈõªË¶ñÁï´Èù¢ËÆäÊàê‰∫ÜÈõ™Ëä±ÈõúË®ä)", char: "char_tv", object: true },
            { type: "choice", text: "ÈÄöÂ∏∏ÊÇ®ÊúÉÊÄéÈ∫ºÂÅöÔºü", choices: [{ t: "Ê™¢Êü•Ë®äËôüÁ∑öÊé•È†≠", s: 0, money: 150 }, { t: "Áî®ÂäõÊãçÊâìÈõªË¶ñ", s: 1, money: 0, reaction: {text: "Â∫óÈï∑: ÂìéÂî∑ÔºÅÊâãÂ•ΩÁóõ... ÈÄôÁ®ÆËÄÅÈõªË¶ñÊãç‰∫Ü‰πüÊ≤íÁî®ÔºåÊáâË©≤ÊòØË¶ÅÊ™¢Êü•Ë®äËôüÁ∑öÊâçÂ∞ç„ÄÇ", speaker: "Â∫óÈï∑"} }], char: "char_tv", object: true }, 
            { type: "talk", speaker: "Â∫óÈï∑", text: "‰øÆÂ•Ω‰∫ÜÔºÅÊûúÁÑ∂ÊòØÁ∑öÈ¨Ü‰∫Ü„ÄÇ", char: null }, 
            { type: "talk", speaker: "Èô≥Â§™Â§™", text: "ËÄÅÈóÜÁµêÂ∏≥ÔºÅÊàëË¶ÅË≤∑ÈÄô‰∫õÈÜ¨Ê≤πÂíåÁ≥ñ„ÄÇ", char: "char_customer" },
            { type: "talk", speaker: "Â∫óÈï∑", text: "Â•ΩÔºå‰∏ÄÂÖ±ÊòØ 345 ÂÖÉ„ÄÇ", char: "char_customer" },
            { type: "talk", speaker: "ÊóÅÁôΩ", text: "(ÂÆ¢‰∫∫ÈÅûÁµ¶ÊÇ®‰∏ÄÂºµ 1000 ÂÖÉÂ§ßÈàî)", char: "char_customer" }, 
            { type: "number_input", text: "Ë´ãËº∏ÂÖ•ÊâæÈõ∂ÈáëÈ°çÔºö", answer: 655, correct: { s: 0, money: 345 }, wrong: { s: 1, money: 0, reaction: {text: "Èô≥Â§™Â§™: ÂìéÂëÄÊàëË∂ïËëóÂõûÂÆ∂ÁÖÆÈ£ØÔºåÊ≤íÁ¥∞ÁúãÂï¶ÔºÅË¨ùÂï¶ËÄÅÈóÜÔºÅ", speaker: "Èô≥Â§™Â§™"} }, char: "char_customer" },
            { type: "talk", speaker: "Èô≥Â§™Â§™", text: "ÁÆóÂæóÊ≤íÈåØÔºåË¨ùË¨ùËÄÅÈóÜÔºÅ", char: "char_customer" }, 
            { type: "talk", speaker: "ÊóÅÁôΩ", text: "(Èô≥Â§™Â§™ÈñãÂøÉÂú∞ÊèêËëóÈÜ¨Ê≤πÂõûÂÆ∂ÁÖÆÈ£Ø‰∫Ü)", char: null }, 
            { type: "scene", bg: "bg_evening", time: "16:00" },
            { type: "talk", speaker: "Á±≥Â∫óÈòøÂº∑", text: "ËÄÅÈóÜÔºÅÊàë‰æÜÈÄÅÁ±≥‰∫ÜÔºÅ", char: "char_delivery" },
            { type: "talk", speaker: "Á±≥Â∫óÈòøÂº∑", text: "Êä±Ê≠âÊúâÈªûÈÅ≤Âà∞ÔºåË´ãÂïèÊàëÂÄëÊó©‰∏äÈõªË©±Ë£°ÊòØÁ¥ÑÂπæÈªûÔºü", char: "char_delivery" },
            { type: "time_picker", text: "Êó©‰∏äÁ¥ÑÂÆöÁöÑÊôÇÈñìÊòØÔºü", answer: [16, 4], correct: { s: 0, money: 100, reaction: {text: "Á±≥Â∫óÈòøÂº∑: Ê≤íÈåØÔºÅËÄÅÈóÜË®òÊÄßÁúüÂ•ΩÔºåÂâõÂ•Ω 4 ÈªûÊï¥„ÄÇ", speaker: "Á±≥Â∫óÈòøÂº∑"} }, wrong: { s: 1, money: 0, reaction: {text: "Á±≥Â∫óÈòøÂº∑: ËÄÅÈóÜ... ÊàëÂÄëÊòØÁ¥Ñ‰∏ãÂçà 4 ÈªûÊçèÔºåÁèæÂú®ÈÉΩÂà∞‰∫ÜÔºå‰Ω†Ë®òÈåØ‰∫ÜÂêßÔºü", speaker: "Á±≥Â∫óÈòøÂº∑"} }, char: "char_delivery" }, 
            { type: "talk", speaker: "Á±≥Â∫óÈòøÂº∑", text: "Â•ΩÂï¶Ê≤íÈóú‰øÇÔºåÈÇ£ÊàëË∂ïÂø´Âç∏Ë≤®„ÄÇ", char: "char_delivery" }, 
            { type: "talk", speaker: "ÊóÅÁôΩ", text: "(Á±≥Â∫óÈòøÂº∑Âç∏ÂÆåË≤®Èõ¢Èñã‰∫Ü)", char: null }, 
            { type: "scene", bg: "bg_night", time: "18:00" },
            { type: "talk", speaker: "Â∫óÈï∑", text: "Â§©Èªë‰∫ÜÔºåË©≤ÊãâÈêµÈñÄ‰ºëÊÅØ‰∫Ü„ÄÇ", char: null },
            { type: "scene", bg: "bg_desktop", time: "18:00" },
            { type: "talk", speaker: "Â∫óÈï∑", text: "Á≥üÁ≥ïÔºåÊâã‰∏äÁöÑÈë∞Âåô‰∏≤ÂâõÊâçÈö®Êâã‰∏ÄÊîæÔºå‰∏çÁü•ÈÅìÂú®Âì™Ôºü", char: null },
            { type: "choice", text: "Ë´ãÈÅ∏ÊìáÂ∞ãÊâæÂçÄÂüüÔºö", choices: [{ t: "ÂéªÊ´ÉÂè∞Ê°åÈù¢ÊâæÊâæ", s: 0, money: 200, key: true }, { t: "ÂéªÂÜ∞ÁÆ±Ë£°Èù¢ÊâæÊâæÁúã", s: 1, money: 0 }], char: null },
            { type: "key_search", text: "Â∫óÈï∑: ÂïäÔºÅÂéü‰æÜÂú®ÈÄôË£°„ÄÇ(Ë´ãÈªûÊìäÈë∞Âåô)" },
            { type: "talk", speaker: "Â∫óÈï∑", text: "‰ªäÂ§©ÁúüÊòØÂøôÁ¢åÂèàÂÖÖÂØ¶ÁöÑ‰∏ÄÂ§©Âë¢„ÄÇ", char: null },
            { type: "end" }
        ];

        let index = 0, riskScore = 0, totalMoney = 0;
        let activeCharIndex = 1;
        let typeWriterTimer = null;
        let isMusicOn = true;
        let speechSynth = window.speechSynthesis;
        let currentUtterance = null;
        
        const dom = {
            bg: document.getElementById('bg-layer'),
            char1: document.getElementById('char-1'),
            char2: document.getElementById('char-2'),
            overlay: document.getElementById('interaction-overlay'),
            title: document.getElementById('interaction-title'),
            titleText: document.getElementById('title-text'),
            content: document.getElementById('interaction-content'),
            dialog: document.getElementById('dialog-area'),
            speakerBox: document.getElementById('speaker-box'),
            speakerName: document.getElementById('speaker-name'),
            text: document.getElementById('dialog-text'),
            hudTime: document.getElementById('game-time'),
            hudMoney: document.getElementById('game-money'),
            key: document.getElementById('key-item'),
            startBtn: document.getElementById('start-btn'),
            musicToggle: document.getElementById('music-toggle'),
            // ÊäìÂèñ‰øÆÊ≠£ÂæåÁöÑ ID
            bgm: document.getElementById('bgMusic')
        };

        const bgm = dom.bgm;
        
        function toggleMusic() {
            isMusicOn = !isMusicOn;
            const icon = dom.musicToggle.querySelector('i');
            if (isMusicOn) {
                dom.musicToggle.classList.remove('music-off');
                icon.className = 'fas fa-volume-up';
                bgm.play().catch(e=>{});
            } else {
                dom.musicToggle.classList.add('music-off');
                icon.className = 'fas fa-volume-mute';
                bgm.pause();
                if(currentUtterance) speechSynth.cancel();
            }
        }

        // Èü≥ÈáèÊéßÂà∂ÔºöÊúÄÂ§ßÈü≥ÈáèË®≠ÁÇ∫ 0.8
        bgm.addEventListener('timeupdate', () => {
            if (!isMusicOn) return;
            const t = bgm.currentTime; const d = bgm.duration;
            if (!d) return;
            // 5ÁßíÊ∑°ÂÖ•ÔºåÁõÆÊ®ôÊúÄÂ§ßÈü≥Èáè 0.8
            if (t < 5) bgm.volume = (t / 5) * 0.8; 
            // ÁµêÊùüÂâç 5 ÁßíÊ∑°Âá∫
            else if (t > d - 5) bgm.volume = Math.max(0, (d - t) / 5) * 0.8;
            else bgm.volume = 0.8;
        });

        function speak(text, role) {
            if (!isMusicOn) return; 
            speechSynth.cancel(); 
            const u = new SpeechSynthesisUtterance(text);
            u.lang = 'zh-TW';
            const profile = VOICE_PROFILES[role] || { pitch: 1.0, rate: 1.0 };
            u.pitch = profile.pitch;
            u.rate = profile.rate;
            currentUtterance = u;
            speechSynth.speak(u);
        }

        function replayVoice() {
            const scene = SCRIPT[index];
            if(scene && scene.text) speak(scene.text, scene.speaker);
        }

        function speakTitle() {
            const scene = SCRIPT[index];
            if(scene && scene.text) speak(scene.text, "ÊóÅÁôΩ");
        }

        function speakChoice(text) {
            speak(text, "ÊóÅÁôΩ");
        }

        window.onload = function() {
            resizeApp(); 
            
            let loadedCount = 0;
            const assetKeys = Object.keys(ASSETS);
            const totalAssets = assetKeys.length;
            const checkProgress = () => {
                loadedCount++;
                const percent = Math.floor((loadedCount / totalAssets) * 100);
                dom.startBtn.innerHTML = `<i class="fas fa-spinner fa-spin"></i> ÈÅäÊà≤ËºâÂÖ•‰∏≠ (${percent}%)`;
                if (loadedCount >= totalAssets) {
                    dom.startBtn.innerHTML = "ÈñãÂßãÁáüÊ•≠";
                    dom.startBtn.disabled = false;
                    dom.startBtn.classList.add('pulse');
                }
            };
            assetKeys.forEach(key => {
                const img = new Image();
                img.onload = checkProgress; img.onerror = checkProgress; 
                img.src = ASSETS[key];
            });
            bgm.load();
        };

        function startGame() {
            document.getElementById('intro-overlay').style.display = 'none';
            dom.key.src = ASSETS.char_keys; 
            render();
            // Âº∑Âà∂Êí≠ÊîæÈü≥Ê®Ç
            if(isMusicOn) {
                bgm.volume = 0;
                bgm.play().catch(e => {
                    console.log("Ëá™ÂãïÊí≠ÊîæË¢´ÊîîÊà™ÔºåÂ∞áÂú®‰ΩøÁî®ËÄÖ‰∏ã‰∏ÄÊ¨°ÈªûÊìäÊôÇÂòóË©¶");
                });
            }
        }

        function render() {
            const scene = SCRIPT[index];

            if (scene.type === "scene") {
                dom.bg.style.backgroundImage = `url('${ASSETS[scene.bg]}')`;
                if (scene.bg === "bg_evening") dom.bg.style.filter = "brightness(0.8) sepia(0.3)";
                else if (scene.bg === "bg_night") dom.bg.style.filter = "brightness(0.5) contrast(1.2)";
                else dom.bg.style.filter = "none";
                dom.hudTime.innerText = scene.time;
                dom.char1.className = 'char-img'; dom.char2.className = 'char-img'; 
                index++; render();
                return;
            }

            if (scene.type === "end") { showReport(); return; }

            if (scene.type === "key_search") {
                dom.overlay.style.display = 'none';
                dom.speakerName.innerText = "Á≥ªÁµ±ÊèêÁ§∫";
                typeWriter("Ë´ãÂú®Áï´Èù¢‰∏äÈªûÊìäÈë∞Âåô...", dom.text);
                speak("Ë´ãÂú®Áï´Èù¢‰∏äÈªûÊìäÈë∞Âåô", "ÊóÅÁôΩ"); 
                dom.key.style.display = 'block';
                dom.key.onclick = () => {
                    dom.key.style.display = 'none';
                    dom.speakerName.innerText = "Â∫óÈï∑";
                    typeWriter("ÊâæÂà∞‰∫ÜÔºÅÂéü‰æÜÂ£ìÂú®Êñá‰ª∂‰∏ãÈù¢„ÄÇ", dom.text);
                    speak("ÊâæÂà∞‰∫ÜÔºÅÂéü‰æÜÂ£ìÂú®Êñá‰ª∂‰∏ãÈù¢„ÄÇ", "Â∫óÈï∑"); 
                    setTimeout(() => { index++; render(); }, 2000);
                };
                return;
            }

            updateCharacter(scene);

            if (scene.type === 'choice') showChoice(scene);
            else if (scene.type === 'date_input') showDateInput(scene);
            else if (scene.type === 'number_input') showNumberInput(scene);
            else if (scene.type === 'time_picker') showTimePicker(scene); 
            else showTalk(scene);
        }

        function showTalk(scene) {
            dom.overlay.style.display = 'none';
            dom.speakerName.innerText = scene.speaker;
            typeWriter(scene.text, dom.text);
            speak(scene.text, scene.speaker); 
        }

        function showChoice(scene) {
            dom.overlay.style.display = 'flex';
            dom.titleText.innerText = scene.text;
            dom.content.innerHTML = "";
            speak(scene.text, "ÊóÅÁôΩ"); 

            scene.choices.forEach(opt => {
                const wrapper = document.createElement('div');
                wrapper.style.display = "flex"; wrapper.style.alignItems = "center"; wrapper.style.width="100%";
                const speakBtn = document.createElement('div');
                speakBtn.className = "choice-speak-icon";
                speakBtn.innerHTML = '<i class="fas fa-volume-up"></i>';
                speakBtn.onclick = (e) => { e.stopPropagation(); speakChoice(opt.t); };
                const btn = document.createElement('button');
                btn.className = 'choice-btn';
                btn.innerHTML = `<span>${opt.t}</span> <i class="fas fa-chevron-right"></i>`;
                btn.onclick = () => {
                    const resultData = { s: opt.s, money: opt.money, reaction: opt.reaction };
                    processResult(resultData, opt.key);
                };
                wrapper.appendChild(speakBtn); wrapper.appendChild(btn); dom.content.appendChild(wrapper);
            });
        }

        function showDateInput(scene) {
            dom.overlay.style.display = 'flex';
            dom.titleText.innerText = scene.text;
            speak(scene.text, "ÊóÅÁôΩ"); 
            dom.content.innerHTML = `
                <div class="input-group">
                    <select id="yy" class="custom-select"></select>
                    <select id="mm" class="custom-select"></select>
                    <select id="dd" class="custom-select"></select>
                </div>
                <button class="confirm-btn" onclick="checkDate()">Á¢∫Ë™ç</button>
            `;
            const now = new Date();
            const y = now.getFullYear(); 
            const yy = document.getElementById('yy'); const mm = document.getElementById('mm'); const dd = document.getElementById('dd');
            [y-1, y, y+1].forEach(yr => { yy.innerHTML += `<option value="${yr}">${yr-1911} Âπ¥</option>`; });
            yy.value = y;
            for(let i=1; i<=12; i++) mm.innerHTML += `<option value="${i-1}">${i} Êúà</option>`; mm.value = now.getMonth();
            for(let i=1; i<=31; i++) dd.innerHTML += `<option value="${i}">${i} Êó•</option>`; dd.value = now.getDate();
            window.checkDate = () => {
                const selY = parseInt(yy.value); const selM = parseInt(mm.value); const selD = parseInt(dd.value);
                const isCorrect = (selY === now.getFullYear() && selM === now.getMonth() && selD === now.getDate());
                handleResult(isCorrect, scene);
            };
        }

        function showNumberInput(scene) {
            dom.overlay.style.display = 'flex';
            dom.titleText.innerText = scene.text;
            speak(scene.text, "ÊóÅÁôΩ"); 
            dom.content.innerHTML = `
                <div id="numpad-display"></div>
                <div id="numpad">
                    ${[1,2,3,4,5,6,7,8,9].map(n => `<button class="num-btn" onclick="addNum(${n})">${n}</button>`).join('')}
                    <button class="num-btn" onclick="clearNum()">C</button>
                    <button class="num-btn" onclick="addNum(0)">0</button>
                    <button class="num-btn" style="background:#48bb78" onclick="checkNum()">OK</button>
                </div>
            `;
            let val = "";
            const display = document.getElementById('numpad-display');
            window.addNum = (n) => { if(val.length<5) val+=n; display.innerText = val; };
            window.clearNum = () => { val=""; display.innerText = ""; };
            window.checkNum = () => {
                const inputVal = parseInt(val);
                const isCorrect = (inputVal === scene.answer);
                handleResult(isCorrect, scene);
            };
        }

        function showTimePicker(scene) {
            dom.overlay.style.display = 'flex';
            dom.titleText.innerText = scene.text;
            speak(scene.text, "ÊóÅÁôΩ"); 
            
            dom.content.innerHTML = `
                <div class="time-picker-container">
                    <div class="ampm-toggle">
                        <button class="ampm-btn active" id="btn-pm" onclick="setAmPm('PM')">‰∏ãÂçà</button>
                        <button class="ampm-btn" id="btn-am" onclick="setAmPm('AM')">‰∏äÂçà</button>
                    </div>
                    <div class="hour-selector">
                        ${[1,2,3,4,5,6,7,8,9,10,11,12].map(h => 
                            `<div class="hour-btn" onclick="selectHour(${h}, this)">${h}</div>`
                        ).join('')}
                    </div>
                </div>
                <button class="confirm-btn" onclick="checkTimePicker()">Á¢∫Ë™ç</button>
            `;
            
            let selectedPeriod = 'PM';
            let selectedHour = null;

            window.setAmPm = (p) => {
                selectedPeriod = p;
                document.getElementById('btn-pm').className = p==='PM' ? 'ampm-btn active' : 'ampm-btn';
                document.getElementById('btn-am').className = p==='AM' ? 'ampm-btn active' : 'ampm-btn';
            };

            window.selectHour = (h, el) => {
                selectedHour = h;
                document.querySelectorAll('.hour-btn').forEach(b => b.classList.remove('selected'));
                el.classList.add('selected');
            };

            window.checkTimePicker = () => {
                if(selectedHour === null) return alert("Ë´ãÈÅ∏ÊìáÊôÇÈñì");
                let finalH = selectedHour;
                if(selectedPeriod === 'PM' && selectedHour !== 12) finalH += 12;
                if(selectedPeriod === 'AM' && selectedHour === 12) finalH = 0;
                const isCorrect = scene.answer.includes(finalH) || (selectedPeriod === 'PM' && scene.answer.includes(selectedHour));
                handleResult(isCorrect, scene);
            };
        }

        function handleResult(isCorrect, scene) {
            const resultData = isCorrect ? scene.correct : scene.wrong;
            processResult(resultData, false);
        }

        function processResult(data, isKeyTask) {
            riskScore += data.s;
            totalMoney += data.money;
            dom.hudMoney.innerText = totalMoney;
            dom.overlay.style.display = 'none'; 

            if (data.reaction) {
                dom.speakerName.innerText = data.reaction.speaker;
                dom.dialog.style.display = 'flex'; 
                typeWriter(data.reaction.text, dom.text, () => { waitForClick(); });
                speak(data.reaction.text, data.reaction.speaker); 
            } else {
                if (isKeyTask) { index++; dom.overlay.style.display = 'none'; render(); } 
                else { index++; if (SCRIPT[index] && SCRIPT[index].type === 'key_search') index++; dom.overlay.style.display = 'none'; render(); }
            }
        }

        function waitForClick() {
            const handler = () => { dom.dialog.removeEventListener('click', handler); index++; render(); };
            setTimeout(() => dom.dialog.addEventListener('click', handler), 500);
        }

        function updateCharacter(scene) {
            const activeEl = activeCharIndex === 1 ? dom.char1 : dom.char2;
            const nextEl = activeCharIndex === 1 ? dom.char2 : dom.char1;
            if (scene.char && ASSETS[scene.char]) {
                const targetSrc = ASSETS[scene.char];
                if (!activeEl.src.includes(targetSrc) || !activeEl.classList.contains('char-visible')) {
                    if (scene.object) nextEl.classList.add('object-mode'); else nextEl.classList.remove('object-mode');
                    nextEl.src = targetSrc;
                    nextEl.onload = () => { nextEl.classList.add('char-visible'); activeEl.classList.remove('char-visible'); activeCharIndex = activeCharIndex === 1 ? 2 : 1; };
                }
            } else {
                dom.char1.classList.remove('char-visible'); dom.char2.classList.remove('char-visible');
            }
        }

        function typeWriter(text, element, callback) {
            if (typeWriterTimer) clearInterval(typeWriterTimer);
            element.innerText = "";
            let i = 0;
            typeWriterTimer = setInterval(() => {
                element.innerText += text.charAt(i); i++;
                if (i >= text.length) { clearInterval(typeWriterTimer); typeWriterTimer = null; if (callback) callback(); }
            }, 30);
        }

        function advanceStory() {
            if (dom.overlay.style.display === 'flex') return;
            if (document.getElementById('key-item').style.display === 'block') return;
            if (typeWriterTimer) { clearInterval(typeWriterTimer); typeWriterTimer = null; dom.text.innerText = SCRIPT[index].text || ""; return; }
            index++; if (index < SCRIPT.length) render();
        }

        function showReport() {
            document.getElementById('report-overlay').style.display = 'flex';
            document.getElementById('report-money').innerText = `$${totalMoney}`;
            const stamp = document.getElementById('final-stamp');
            const advice = document.getElementById('report-advice');
            const riskLabel = document.getElementById('report-risk');
            speak("‰ªäÊó•ÁáüÈÅãÁµêÊùüÔºåË´ãÁúãÊÇ®ÁöÑÁáüÈÅãÂ†±Âëä", "ÊóÅÁôΩ");

            if (riskScore <= 1) {
                stamp.innerText = "ÈáëÁâåÂ∫óÈï∑"; stamp.style.borderColor = "#f6ad55"; stamp.style.color = "#f6ad55";
                riskLabel.innerText = "S Á¥ö (ÂÑ™Áï∞)"; advice.innerText = "Â§™Âé≤ÂÆ≥‰∫ÜÔºÅÊÇ®ÁöÑË®òÊÜ∂ÂäõËàáÂà§Êñ∑ÂäõÈÉΩÈùûÂ∏∏Ê∏ÖÊô∞ÔºåË´ãÁπºÁ∫å‰øùÊåÅÈÄôÊ®£ÁöÑÁîüÊ¥ªÁØÄÂ•èÔºÅ";
            } else if (riskScore <= 3) {
                stamp.innerText = "ÈäÄÁâåÂ∫óÈï∑"; stamp.style.borderColor = "#718096"; stamp.style.color = "#718096";
                riskLabel.innerText = "A Á¥ö (ËâØÂ•Ω)"; advice.innerText = "Ë°®Áèæ‰∏çÈåØÂñîÔºÅÂÅ∂ÁàæÊúâ‰∫õÂ∞èÂøòË®òÊòØÊ≠£Â∏∏ÁöÑÔºåÂ§öÂãïËÖ¶„ÄÅÂ§öÈÅãÂãïÂèØ‰ª•ËÆìÈ†≠ËÖ¶Êõ¥ÈùàÊ¥ª„ÄÇ";
            } else {
                stamp.innerText = "ÈäÖÁâåÂ∫óÈï∑"; stamp.style.borderColor = "#c53030"; stamp.style.color = "#c53030";
                riskLabel.innerText = "B Á¥ö (Âä†Ê≤π)"; advice.innerText = "ÊúÄËøëÊòØ‰∏çÊòØÊØîËºÉÁ¥ØÂë¢ÔºüÂª∫Ë≠∞ÊâæÊôÇÈñìÂéªÈÜ´Èô¢ÂÅöÂÄãË©≥Á¥∞Ê™¢Êü•ÔºåËÆìÈÜ´ÁîüÂπ´ÊÇ®‰øùÈ§ä‰∏Ä‰∏ãÂ§ßËÖ¶Âñî„ÄÇ";
            }
        }
    </script>
</body>
=======
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Âπ∏Á¶èÊüë‰ªîÂ∫ó</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        /* ÂÖ®Â±ÄÈéñÂÆöÊç≤Âãï */
        html, body { 
            position: fixed; 
            top: 0; left: 0; right: 0; bottom: 0;
            width: 100%; height: 100%;
            margin: 0; padding: 0; 
            background-color: #2d3748; 
            font-family: 'Noto Sans TC', sans-serif; 
            overflow: hidden; 
            overscroll-behavior: none; 
        }

        #mobile-container {
            width: 100%; 
            height: 100%; 
            max-width: 480px;
            margin: 0 auto; 
            background: #000; 
            position: relative; 
            overflow: hidden;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
        }

        /* ËÉåÊôØÂ±§ */
        #bg-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-size: cover; background-position: center;
            transition: opacity 0.5s ease;
            background-color: #333; z-index: 1;
        }

        /* ÈõôÁ∑©Ë°ùËßíËâ≤Â±§ */
        #char-container {
            position: absolute; bottom: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 10;
        }
        .char-img {
            position: absolute; bottom: 0; left: 50%; transform: translateX(-50%);
            max-height: 85%; width: auto; max-width: 95%; 
            opacity: 0; 
            filter: drop-shadow(0 5px 15px rgba(0,0,0,0.4));
            transition: opacity 0.3s ease-in-out; 
        }
        .char-visible { opacity: 1 !important; }
        
        /* ÁâπÊÆä‰ΩçÁΩÆË™øÊï¥ */
        .object-mode { bottom: 25% !important; max-height: 45% !important; }
        .calendar-pos { bottom: 45% !important; max-height: 32% !important; }
        .phone-pos { 
            bottom: 30% !important; 
            max-height: 45% !important; 
            transform: translateX(-50%) scale(0.7) !important; 
        }

        /* HUD */
        #top-hud {
            position: absolute; top: 15px; left: 15px; right: 15px;
            display: flex; justify-content: space-between;
            pointer-events: none; z-index: 20;
        }
        .status-pill {
            background: rgba(0,0,0,0.6); backdrop-filter: blur(5px);
            padding: 8px 16px; border-radius: 25px; font-size: 16px; font-weight: bold;
            border: 1px solid rgba(255,255,255,0.2); color: white;
            display: flex; align-items: center; gap: 8px;
        }

        /* Èü≥Ê®ÇÈñãÈóú */
        #music-toggle {
            position: absolute; top: 15px; right: 15px; z-index: 50;
            width: 44px; height: 44px; border-radius: 50%;
            background: rgba(0,0,0,0.6); border: 2px solid #fff;
            color: white; font-size: 20px; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            pointer-events: auto;
        }

        /* Â∞çË©±Ê°Ü */
        #dialog-area {
            position: absolute; bottom: 0; left: 0; width: 100%; height: 38%;
            background: linear-gradient(to top, rgba(0,0,0,1) 0%, rgba(0,0,0,0.9) 75%, rgba(0,0,0,0) 100%);
            padding: 25px; padding-top: 50px; color: white; z-index: 30;
            display: flex; flex-direction: column; cursor: pointer;
        }
        #speaker-box {
            align-self: flex-start; background: #f6ad55; color: #2d3748;
            padding: 6px 18px; border-radius: 8px; font-weight: bold; font-size: 20px; margin-bottom: 12px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3); transform: translateY(-5px);
            display: flex; align-items: center; gap: 10px; white-space: nowrap;
        }
        #dialog-text { 
            font-size: 22px; line-height: 1.6; flex: 1; overflow-y: auto; 
            text-shadow: 0 1px 2px rgba(0,0,0,0.8); white-space: pre-wrap; word-break: break-all;
        }
        .next-arrow { position: absolute; bottom: 25px; right: 25px; color: #f6ad55; animation: bounce 1s infinite; font-size: 28px; }

        /* ‰∫íÂãïÂ±§ */
        #interaction-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); backdrop-filter: blur(10px);
            z-index: 100; display: none;
            flex-direction: column; justify-content: center; align-items: center; padding: 25px;
        }
        #interaction-title {
            color: white; font-size: 24px; font-weight: bold; text-align: center; margin-bottom: 30px;
            background: rgba(255,255,255,0.1); padding: 15px; border-radius: 12px; width: 100%;
            border: 1px solid rgba(255,255,255,0.2); display: flex; justify-content: space-between; align-items: center;
        }
        #interaction-content { width: 100%; display: flex; flex-direction: column; align-items: center; }

        /* ÊåâÈàïÊ®£Âºè */
        .choice-btn {
            background: white !important; color: #2d3748 !important; width: 100%; 
            min-height: 64px; padding: 12px 24px; margin-bottom: 16px;
            border-radius: 50px; border: none; font-size: 20px; font-weight: bold;
            box-shadow: 0 4px 0 #cbd5e0; transition: transform 0.1s;
            display: flex; justify-content: space-between; align-items: center; cursor: pointer;
            flex-shrink: 0;
        }
        .choice-btn:active { transform: translateY(4px); box-shadow: none; background: #e2e8f0 !important; }

        /* Ëº∏ÂÖ•‰ªãÈù¢ */
        .input-group { display: flex; gap: 8px; margin-bottom: 25px; width: 100%; justify-content: center; }
        .custom-select { padding: 12px 4px; font-size: 18px; border-radius: 10px; border: 3px solid #f6ad55; background: #fff; color: #2d3748; font-weight: bold; text-align: center; flex: 1; min-width: 0; }
        .confirm-btn { background: #48bb78 !important; color: white !important; padding: 18px 40px; border-radius: 50px; font-size: 24px; font-weight: bold; border: none; cursor: pointer; box-shadow: 0 6px 0 #2f855a; width: 100%; margin-top: 15px; }

        /* Numpad */
        #numpad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; width: 100%; margin-bottom: 15px; }
        .num-btn { background: rgba(255,255,255,0.15); color: white; border: 2px solid rgba(255,255,255,0.3); padding: 18px; font-size: 26px; font-weight: bold; border-radius: 12px; cursor: pointer; }
        .num-btn:active { background: rgba(255,255,255,0.4); }
        .del-btn { color: #feb2b2; }
        #numpad-display { width: 100%; background: #fff; color: #2d3748; font-size: 40px; font-weight: bold; text-align: center; padding: 12px; border-radius: 12px; margin-bottom: 20px; border: 4px solid #f6ad55; letter-spacing: 3px; height: 85px; display: flex; align-items: center; justify-content: center; }

        /* Time Picker */
        .time-picker-container { display: flex; flex-direction: column; align-items: center; width: 100%; background: white; border-radius: 20px; padding: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .ampm-toggle { display: flex; background: #e2e8f0; border-radius: 50px; padding: 5px; margin-bottom: 20px; width: 100%; }
        .ampm-btn { flex: 1; padding: 12px; border-radius: 40px; border: none; font-size: 20px; font-weight: bold; cursor: pointer; background: transparent; color: #718096; }
        .ampm-btn.active { background: #3b82f6; color: white; }
        .hour-selector { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; width: 100%; }
        .hour-btn { background: #f7fafc; border: 2px solid #e2e8f0; border-radius: 12px; padding: 15px 0; font-size: 22px; font-weight: bold; color: #2d3748; cursor: pointer; }
        .hour-btn.selected { border-color: #f6ad55; background: #fffaf0; color: #ed8936; box-shadow: 0 0 0 2px #f6ad55; }

        /* Report */
        #report-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 200; backdrop-filter: blur(10px); display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 40px; text-align: center; color: white; }
        .report-card { background: #fff; width: 100%; padding: 35px 25px; border-radius: 25px; box-shadow: 0 10px 50px rgba(0,0,0,0.8); text-align: center; color: #2d3748; }
        .stamp { border: 5px solid #e53e3e; color: #e53e3e; border-radius: 15px; padding: 10px 25px; font-size: 32px; font-weight: bold; transform: rotate(-5deg); margin: 30px auto; display: inline-block; }

        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(5px); } }
    </style>
</head>
<body>

    <div id="mobile-container">
        <audio id="bgMusic" loop preload="auto"><source src="assets/audio/bgm.mp3" type="audio/mpeg"></audio>

        <div id="music-toggle" onclick="toggleMusic()">
            <i class="fas fa-volume-up"></i>
        </div>

        <div id="bg-layer"></div>
        
        <div id="char-container">
            <img id="char-1" class="char-img" alt="C1">
            <img id="char-2" class="char-img" alt="C2">
        </div>
        
        <img id="key-item" style="position:absolute; top:60%; left:70%; width:100px; display:none; z-index:15; cursor:pointer;" src="assets/images/key.png" alt="Key">
        
        <div id="top-hud">
            <div class="status-pill"><i class="fas fa-clock"></i> <span id="game-time">08:00</span></div>
            <div class="status-pill" style="margin-right: 50px;"><i class="fas fa-coins"></i> ÁáüÊî∂: <span id="game-money">0</span></div>
        </div>
        
        <div id="dialog-area" onclick="advanceStory()">
            <div id="speaker-box">
                <span id="speaker-name">...</span>
                <div class="read-btn" onclick="event.stopPropagation(); replayVoice()"><i class="fas fa-volume-up"></i></div>
            </div>
            <div id="dialog-text">...</div>
            <div class="next-arrow"><i class="fas fa-caret-down"></i></div>
        </div>
        
        <div id="interaction-overlay">
            <div id="interaction-title">
                <span id="title-text">Ë´ãÈÅ∏Êìá</span>
                <div class="title-speak-btn" style="background: rgba(255,255,255,0.2); width:32px; height:32px; border-radius:50%; display:flex; align-items:center; justify-content:center; cursor:pointer;" onclick="speakTitle()"><i class="fas fa-volume-up"></i></div>
            </div>
            <div id="interaction-content"></div>
        </div>

        <div id="intro-overlay" style="position:absolute; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:200; display:flex; flex-direction:column; align-items:center; justify-content:center; padding:40px; text-align:center; color:white;">
            <div style="font-size: 40px; font-weight: bold; color: #f6ad55; margin-bottom: 25px;">Âπ∏Á¶èÊüë‰ªîÂ∫ó</div>
            <div style="font-size:20px; line-height:1.8; color:#e2e8f0; margin-bottom:40px;">Ê≠°ËøéÂÖâËá®ÔºÅ<br>‰ªäÂ§©ÊÇ®Â∞áÂåñË∫´ÁÇ∫<b>„Äå‰∏ÄÊó•Â∫óÈï∑„Äç</b>Ôºå<br>Ë´ãÁôºÊèÆÊÇ®ÁöÑÊô∫ÊÖßËàáÁ∂ìÈ©óÔºå<br>ËôïÁêÜÊüë‰ªîÂ∫óÁöÑÂ§ßÂ∞è‰∫ãÂêßÔºÅ</div>
            <button id="start-btn" onclick="startGame()" disabled style="background: linear-gradient(135deg, #f6ad55, #ed8936); color: #fff; border: none; padding: 18px 70px; border-radius: 50px; font-size: 24px; font-weight: bold; cursor: pointer; transition: 0.3s; opacity: 0.7;">ÈÅäÊà≤ËºâÂÖ•‰∏≠...</button>
        </div>
        
        <div id="report-overlay" style="display:none;">
            <div class="report-card">
                <h2 style="margin:0;">üìÖ Êú¨Êó•ÁáüÈÅãÊó•Â†±</h2>
                <div id="final-stamp" class="stamp">ÈáëÁâåÂ∫óÈï∑</div>
                <div style="display:flex; justify-content:space-between; border-bottom:1px dashed #ccc; padding:15px 0;">
                    <span>ÁáüÈÅãÁ©çÂàÜ</span><span id="report-money" style="font-weight:bold; color:#38a169; font-size:22px;">$0</span>
                </div>
                <div style="display:flex; justify-content:space-between; border-bottom:1px dashed #ccc; padding:15px 0;">
                    <span>Â∞àÊ≥®ÂäõË©ïÁ¥ö</span><span id="report-risk" style="font-weight:bold; font-size:22px;">S Á¥ö</span>
                </div>
                <p id="report-advice" style="font-size:18px; margin-top:25px; text-align:left; background:#f7fafc; padding:20px; border-radius:15px; line-height:1.6;">...</p>
            </div>
            <button onclick="location.reload()" style="background:#4fd1c5; color:white; border:none; padding:18px 50px; border-radius:50px; font-size:22px; font-weight:bold; margin-top:30px; cursor:pointer;">ÊòéÊó•ÁπºÁ∫åÁáüÊ•≠</button>
        </div>
    </div>

    <script>
        const ASSETS = {
            bg_morning: "assets/images/store-day.jpg",
            bg_noon: "assets/images/store-day.jpg",
            bg_evening: "assets/images/store-dusk.jpg",
            bg_night: "assets/images/store-night.jpg",
            bg_desktop: "assets/images/desktop.jpg",
            char_oldman: "assets/images/wang.png",
            char_delivery: "assets/images/deliveryboy.png",
            char_customer: "assets/images/mrschen.png", 
            char_tv: "assets/images/tv.png",
            char_keys: "assets/images/key.png",
            char_phone: "assets/images/phone.png", 
            char_clock: "assets/images/calendar.png" 
        };

        const VOICE_PROFILES = {
            "Â∫óÈï∑": { pitch: 1.0, rate: 1.0 },
            "ÊóÅÁôΩ": { pitch: 1.0, rate: 1.1 },
            "ËÇâË≤©Â∞èÂäâ": { pitch: 1.5, rate: 1.4 }, 
            "Á±≥Â∫óÈòøÂº∑": { pitch: 0.7, rate: 1.2 },
            "ËÄÅÁéã": { pitch: 0.6, rate: 0.8 }, 
            "Èô≥Â§™Â§™": { pitch: 1.4, rate: 1.1 }
        };

        // ================= ÂÆåÊï¥ÂäáÊú¨ (Ë£úÂÖ®ËΩâÂ†¥ËàáÂ∞çË©±) =================
        const SCRIPT = [
            { type: "scene", bg: "bg_morning", time: "08:00" },
            { type: "talk", speaker: "Â∫óÈï∑", text: "Êó©ÂÆâÔºÅÂèàÊòØÂÖÖÊªøÊ¥ªÂäõÁöÑ‰∏ÄÂ§©„ÄÇ" },
            { type: "talk", speaker: "Â∫óÈï∑", text: "È¶ñÂÖàË¶ÅÊääÊó•ÊõÜÊíïÂà∞‰ªäÂ§©... Âí¶Ôºü‰ªäÂ§©ÊòØÂπæËôüÔºü", char: "char_clock" },
            { type: "date_input", text: "Ë´ãÈÅ∏Êìá‰ªäÊó•ÁöÑÊ≠£Á¢∫Êó•ÊúüÔºö", char: "char_clock",
              correct: { money: 100, s: 0, reaction: {text: "Êó•ÊõÜÊèõÂ•Ω‰∫ÜÔºåÊ∫ñÂÇôÈñãÂßãÊâìÊãºÔºÅ", speaker: "Â∫óÈï∑"} },
              wrong: { money: 0, s: 1, reaction: {text: "Êó•ÊúüÂ•ΩÂÉè‰∏çÂ§™Â∞çÔºåÁÆó‰∫ÜÂÖà‰∏çÁÆ°ÂÆÉÔºåÈñãÂßãÊâìÊãºÔºÅ", speaker: "Â∫óÈï∑"} } },
            
            { type: "talk", speaker: "ÊóÅÁôΩ", text: "(ÈñÄÂè£ÈÄÅ‰æÜ‰∏ÄÂ§ßÁÆ±‰πñ‰πñÈÄ≤Ë≤®‰∫ÜÔºåÂ†ÜÂæó‰∫Ç‰∏ÉÂÖ´Á≥ü„ÄÇ)" },
            { type: "talk", speaker: "Â∫óÈï∑", text: "‰πñ‰πñÈÄ≤Ë≤®‰∫ÜÔºå‰ΩÜÂ†ÜÂæó‰∫Ç‰∏ÉÂÖ´Á≥ü„ÄÇ‰ª•ÂâçÊàëÊúÄÂñúÊ≠°Êì∫Êï¥ÈΩä‰∫Ü...", char: null },
            { type: "choice", text: "ÊÇ®ÁèæÂú®ÁöÑÊÉ≥Ê≥ïÊòØÔºü", choices: [
                { t: "ÂÜçÁ¥Ø‰πüË¶ÅÂ•ΩÂ•ΩÊï¥ÁêÜ‰∏Ä‰∏ãÔºåÁîüÊÑèÊâçÊúÉÂ•Ω", s: 0, money: 200, reaction: {text: "Â•ΩÔºåÊï¥ÁêÜÂÆå‰∫ÜÔºåÁúãËëóÊï¥ÈΩäÂøÉË£°Â∞±ËàíÊúç„ÄÇ", speaker: "Â∫óÈï∑"} },
                { t: "Â•ΩÁ¥ØÂñîÔºåÂÅ∑Êá∂‰∏Ä‰∏ãÔºåÁîüÊÑè‰∏çÊúÉÂ∑ÆÂ§öÂ∞ë", s: 1, money: 0, reaction: {text: "ÂîâÔºåÁúüÁöÑÂ§™Á¥Ø‰∫ÜÔºåÂÖàÂ∞±ÈÄôÊ®£Èö®‰æøÊîæÂêß„ÄÇ", speaker: "Â∫óÈï∑"} }
            ], char: null },

            // Á¨¨‰∏ÄÈÄöÈõªË©±ËΩâÂ†¥
            { type: "talk", speaker: "ÊóÅÁôΩ", text: "(Èà¥Èà¥Èà¥‚Äî‚Äî Ê´ÉÂè∞ÁöÑÁ¥ÖËâ≤ÈõªË©±Èüø‰∫Ü)", char: "char_phone" },
            { type: "talk", speaker: "ËÇâË≤©Â∞èÂäâ", text: "„ÄéËÄÅÈóÜÂ•ΩÔºåÊàëÊòØËÇâË≤©Â∞èÂäâÔºåÊàëÂÄëÊúâÈÄ≤Âè£È´òÁ¥öÊæ≥Ê¥≤ÁâõËÇâË∂Ö‰æøÂÆúÔºÅ„Äè", char: "char_phone" },
            { type: "talk", speaker: "ËÇâË≤©Â∞èÂäâ", text: "„ÄéÂ§ñÈù¢1Êñ§Ë¶Å‰∏ÄÂçÉÂÖÉÔºåÊàëÈÄôÈÇäÂè™Ë¶ÅË≥£‰∏ÄÁôæÂÖÉÔºåË¶Å‰∏çË¶ÅÂÖàÂåØÈå¢Áµ¶ÊàëÔºü„Äè", char: "char_phone" },
            { type: "choice", text: "ÊÇ®ÁöÑÂèçÊáâÊòØÔºü", choices: [
                { t: "Â•ΩÂÉèÂæàÂàíÁÆóÔºÅÈ¶¨‰∏äÂåØÊ¨æ„ÄÇ", s: 1, money: -500, reaction: {text: "Â•ΩÔºåÂåØÈÅéÂéª‰∫ÜÔºÅÊúüÂæÖÁâõËÇâ... ‰∏çÈÅéÂøÉË£°ÊÄéÈ∫ºÊÄ™ÊÄ™ÁöÑÔºü", speaker: "Â∫óÈï∑"} },
                { t: "ËÅΩËµ∑‰æÜÊòØË©êÈ®ôÔºåÁõ¥Êé•ÊéõÊñ∑„ÄÇ", s: 0, money: 500, reaction: {text: "Âëº... ÁúüÁöÑË¶ÅÂ∞èÂøÉÔºåÈÄôÁµïÂ∞çÊòØË©êÈ®ôÔºå‰∏çËÉΩ‰∏äÁï∂„ÄÇ", speaker: "Â∫óÈï∑"} }
            ], char: "char_phone" },
            
            // Á¨¨‰∫åÈÄöÈõªË©±ËΩâÂ†¥
            { type: "talk", speaker: "ÊóÅÁôΩ", text: "(Èà¥Èà¥Èà¥‚Äî‚Äî ÈõªË©±ÂèàÈüø‰∫Ü)", char: "char_phone" },
            { type: "talk", speaker: "Á±≥Â∫óÈòøÂº∑", text: "„ÄéÂñÇÔºüËÄÅÈóÜÂñîÔºåÊàëÊòØÁ±≥Â∫óÈòøÂº∑Âï¶ÔºÅ‰∏ãÂçà 4 ÈªûÊàëÊúÉÈÅéÂéªÈÄÅË≤®ÔºåÂÖàË∑ü‰Ω†Ë¨õ‰∏ÄËÅ≤ÔºÅ„Äè", char: "char_phone" },
            { type: "talk", speaker: "Â∫óÈï∑", text: "Â•ΩÔºå‰∏ãÂçà 4 ÈªûÔºåÊàëË®ò‰Ωè‰∫Ü„ÄÇ", char: "char_phone" },

            { type: "scene", bg: "bg_morning", time: "10:00" },
            { type: "talk", speaker: "ÊóÅÁôΩ", text: "(ÈöîÂ£ÅÁöÑËÄÅÁéãÊêñËëóÊâáÂ≠êËµ∞‰∫ÜÈÄ≤‰æÜ)", char: "char_oldman" }, 
            { type: "talk", speaker: "ËÄÅÁéã", text: "Â∫óÈï∑Êó©ÂïäÔºÅÊò®Â§©Â§©Ê∞£Â•ΩÔºåÊàëÂéªÂÖ¨ÂúíÊâì‰∫Ü‰∏ÄÂ•óÂ§™Ê•µÊã≥ÂñîÔºÅ", char: "char_oldman" },
            { type: "talk", speaker: "ËÄÅÁéã", text: "ÂòøÂïäÔºåÈÇÑÈÅáÂà∞Èô≥Â™ΩÂ™ΩÔºåËÅä‰∫ÜÂæàÂ§ö„ÄÇ", char: "char_oldman" },
            { type: "choice", text: "ÊÇ®ÊÉ≥Êé•ËëóÂïèËÄÅÁéã‰ªÄÈ∫ºÔºü", choices: [
                { t: "ÈÇ£ÂÖ¨ÂúíÊúâ‰ªÄÈ∫ºÊñ∞ËÆäÂåñÂóéÔºü", s: 0, money: 100, reaction: {text: "ÂìàÂìàÔºåÂ∞±ÈÇ£Ê®£Âï¶„ÄÇÈÇ£ÊàëÂÖàËµ∞‰∫ÜÔºåÊé∞Êé∞ÔºÅ", speaker: "ËÄÅÁéã"} },
                { t: "Êò®Â§©‰Ω†ÂéªÂì™Ë£°ÈÅãÂãïÂïäÔºü", s: 1, money: 0, reaction: {text: "Â∞±Ë™™ÂéªÂÖ¨ÂúíÊâìÂ§™Ê•µÊã≥ÂïäÔºå‰Ω†Âøò‰∫ÜÂñîÔºüÈÇ£ÊàëËµ∞‰∫ÜÔºåÊé∞Êé∞ÔºÅ", speaker: "ËÄÅÁéã"} }
            ], char: "char_oldman" }, 
            { type: "talk", speaker: "ÊóÅÁôΩ", text: "(ËÄÅÁéãÊèÆÊèÆÊâãÈõ¢Èñã‰∫Ü)", char: null }, 

            { type: "scene", bg: "bg_noon", time: "12:00" },
            { type: "talk", speaker: "ÊóÅÁôΩ", text: "(Ê≠£ÂçàÊôÇÂàÜÔºåÂ∫óË£°Ê≤í‰ªÄÈ∫ºÂÆ¢‰∫∫ÔºåÂ∫óÈï∑Âùê‰∏ã‰æÜÊÉ≥ÁúãÂÄãÈõªË¶ñ‰ºëÊÅØ„ÄÇ)" },
            { type: "talk", speaker: "Â∫óÈï∑", text: "‰∏≠Âçà‰ºëÊÅØÁúã‰∏Ä‰∏ãÊñ∞ËÅûÂ•Ω‰∫Ü... ÂìéÂëÄÔºÅ", char: "char_tv", object: true },
            { type: "talk", speaker: "ÊóÅÁôΩ", text: "(ÈõªË¶ñÁï´Èù¢ËÆäÊàê‰∫ÜÈõ™Ëä±ÈõúË®ä)", char: "char_tv", object: true },
            { type: "choice", text: "ÈÄöÂ∏∏ÊÇ®ÊúÉÊÄéÈ∫ºÂÅöÔºü", choices: [
                { t: "Ê™¢Êü•Ë®äËôüÁ∑öÊé•È†≠", s: 0, money: 150, reaction: {text: "‰øÆÂ•Ω‰∫ÜÔºÅÊûúÁÑ∂ÊòØË®äËôüÁ∑öÈ¨Ü‰∫Ü„ÄÇ", speaker: "Â∫óÈï∑"} },
                { t: "Áî®ÂäõÊãçÊâìÈõªË¶ñ", s: 1, money: 0, reaction: {text: "ÂìéÂî∑ÔºÅÊâãÂ•ΩÁóõ... ÈÄôÁ®ÆËÄÅÈõªË¶ñÊãç‰∫Ü‰πüÊ≤íÁî®„ÄÇ", speaker: "Â∫óÈï∑"} }
            ], char: "char_tv", object: true }, 

            { type: "talk", speaker: "ÊóÅÁôΩ", text: "(Ê≠£ÂçàÂâõÈÅéÔºåÈÄôÊôÇÈô≥Â§™Â§™ÊèêËëóÁ±ÉÂ≠êÈÄ≤Â∫ó‰∫Ü...)" },
            { type: "talk", speaker: "Èô≥Â§™Â§™", text: "ËÄÅÈóÜÁµêÂ∏≥ÔºÅÊàëË¶ÅË≤∑ÈÄô‰∫õÈÜ¨Ê≤πÂíåÁ≥ñ„ÄÇ", char: "char_customer" },
            { type: "talk", speaker: "Â∫óÈï∑", text: "Â•ΩÔºå‰∏ÄÂÖ±ÊòØ 345 ÂÖÉ„ÄÇ", char: "char_customer" },
            { type: "talk", speaker: "ÊóÅÁôΩ", text: "(Èô≥Â§™Â§™ÈÅûÁµ¶ÊÇ®‰∏ÄÂºµ 1000 ÂÖÉÂ§ßÈàîÔºåÁ≠âÊÇ®ÊâæÈå¢„ÄÇ)", char: "char_customer" }, 
            { type: "number_input", text: "Ë´ãÂïèË¶ÅÊâæÂ§öÂ∞ëÈå¢Ôºü", answer: 655,
              correct: { s: 0, money: 345, reaction: {text: "ÁÆóÂæóÊ≤íÈåØÔºåË¨ùË¨ùËÄÅÈóÜÔºÅ", speaker: "Èô≥Â§™Â§™"} },
              wrong: { s: 1, money: 0, reaction: {text: "ÂìéÂëÄÊàëË∂ïËëóÂõûÂÆ∂ÁÖÆÈ£ØÔºåÊ≤íÁ¥∞ÁúãÂï¶ÔºÅË¨ùÂï¶ËÄÅÈóÜÔºÅ", speaker: "Èô≥Â§™Â§™"} },
              char: "char_customer" },
            { type: "talk", speaker: "ÊóÅÁôΩ", text: "(Èô≥Â§™Â§™ÈñãÂøÉÂú∞ÊèêËëóÈÜ¨Ê≤πÂõûÂÆ∂ÁÖÆÈ£Ø‰∫Ü)", char: null }, 

            { type: "scene", bg: "bg_evening", time: "16:00" },
            { type: "talk", speaker: "ÊóÅÁôΩ", text: "(Âø´Âà∞Á¥ÑÂÆöÁöÑÊôÇÈñìÔºåÈÄôÊôÇÁ±≥Â∫óÈòøÂº∑ËºâËëóÂπæÂ§ßË¢ãÁ±≥Âà∞‰∫Ü...)" },
            { type: "talk", speaker: "Á±≥Â∫óÈòøÂº∑", text: "ËÄÅÈóÜÔºÅÊàë‰æÜÈÄÅÁ±≥‰∫ÜÔºÅË´ãÂïèÊàëÂÄëÊó©‰∏äÁ¥ÑÂπæÈªûÔºü", char: "char_delivery" },
            { type: "time_picker", text: "Êó©‰∏äÁ¥ÑÂÆöÁöÑÊôÇÈñìÊòØÔºü", answer: [16],
              correct: { s: 0, money: 100, reaction: {text: "Ê≤íÈåØÔºÅËÄÅÈóÜË®òÊÄßÁúüÂ•ΩÔºåÂâõÂ•Ω 4 ÈªûÊï¥„ÄÇ", speaker: "Á±≥Â∫óÈòøÂº∑"} },
              wrong: { s: 1, money: 0, reaction: {text: "ËÄÅÈóÜ... ÊàëÂÄëÊòØÁ¥Ñ‰∏ãÂçà 4 ÈªûÊçèÔºåÁèæÂú®ÈÉΩÂà∞‰∫ÜÔºå‰Ω†Ë®òÈåØ‰∫ÜÂêßÔºü", speaker: "Á±≥Â∫óÈòøÂº∑"} },
              char: "char_delivery" }, 
            { type: "talk", speaker: "ÊóÅÁôΩ", text: "(Á±≥Â∫óÈòøÂº∑Âç∏ÂÆåË≤®Èõ¢Èñã‰∫Ü)", char: null }, 

            { type: "scene", bg: "bg_night", time: "18:00" },
            { type: "talk", speaker: "Â∫óÈï∑", text: "Â§©Èªë‰∫ÜÔºåË©≤ÊãâÈêµÈñÄ‰ºëÊÅØ‰∫Ü„ÄÇ" },
            { type: "scene", bg: "bg_desktop", time: "18:00" },
            { type: "talk", speaker: "Â∫óÈï∑", text: "Á≥üÁ≥ïÔºåÊâã‰∏äÁöÑÈë∞Âåô‰∏≤‰∏çÁü•ÈÅìÊîæÂì™Âéª‰∫ÜÔºü" },
            { type: "choice", text: "Ë´ãÈÅ∏ÊìáÂ∞ãÊâæÂçÄÂüüÔºö", choices: [
                { t: "ÂéªÊ´ÉÂè∞Ê°åÈù¢ÊâæÊâæÁúã", s: 0, money: 200, key: true },
                { t: "ÂéªÂÜ∞ÁÆ±Ë£°Èù¢ÊâæÊâæÁúã", s: 1, money: 0 }
            ] },
            { type: "key_search", text: "ÊâæÂà∞‰∫ÜÔºÅÂéü‰æÜÂ£ìÂú®Êñá‰ª∂‰∏ãÈù¢„ÄÇ", char: null },
            { type: "end" }
        ];

        // ================= Ê†∏ÂøÉÈÇèËºØ =================
        let index = 0, riskScore = 0, totalMoney = 0;
        let activeCharIndex = 1;
        let typeWriterTimer = null;
        let isMusicOn = true;
        let blockAdvance = false; // ÈéñÂÆöÊ©üÂà∂ÔºåÈò≤Ê≠¢Ë∑≥Âπï
        let speechSynth = window.speechSynthesis;

        const dom = {
            bg: document.getElementById('bg-layer'),
            char1: document.getElementById('char-1'),
            char2: document.getElementById('char-2'),
            overlay: document.getElementById('interaction-overlay'),
            titleText: document.getElementById('title-text'),
            content: document.getElementById('interaction-content'),
            dialog: document.getElementById('dialog-area'),
            speakerName: document.getElementById('speaker-name'),
            text: document.getElementById('dialog-text'),
            hudTime: document.getElementById('game-time'),
            hudMoney: document.getElementById('game-money'),
            key: document.getElementById('key-item'),
            startBtn: document.getElementById('start-btn'),
            bgm: document.getElementById('bgMusic')
        };

        function toggleMusic() {
            isMusicOn = !isMusicOn;
            const icon = document.querySelector('#music-toggle i');
            if (isMusicOn) { icon.className = 'fas fa-volume-up'; dom.bgm.play().catch(e=>{}); } 
            else { icon.className = 'fas fa-volume-mute'; dom.bgm.pause(); speechSynth.cancel(); }
        }

        dom.bgm.addEventListener('timeupdate', () => {
            if (!isMusicOn) return;
            const t = dom.bgm.currentTime; const d = dom.bgm.duration;
            if (t < 5) dom.bgm.volume = (t / 5) * 0.8; 
            else if (t > d - 5) dom.bgm.volume = Math.max(0, (d - t) / 5) * 0.8;
            else dom.bgm.volume = 0.8;
        });

        function speak(text, role) {
            if (!isMusicOn) return; 
            speechSynth.cancel(); 
            const u = new SpeechSynthesisUtterance(text);
            u.lang = 'zh-TW';
            const profile = VOICE_PROFILES[role] || { pitch: 1.0, rate: 1.0 };
            u.pitch = profile.pitch; u.rate = profile.rate;
            speechSynth.speak(u);
        }

        function replayVoice() {
            const scene = SCRIPT[index];
            if(scene && scene.text) speak(scene.text, scene.speaker);
        }

        function speakTitle() {
            const scene = SCRIPT[index];
            if(scene && scene.text) speak(scene.text, "ÊóÅÁôΩ");
        }

        window.onload = function() {
            resizeApp(); 
            let loadedCount = 0;
            const assetKeys = Object.keys(ASSETS);
            const checkProgress = () => {
                loadedCount++;
                const percent = Math.floor((loadedCount / assetKeys.length) * 100);
                dom.startBtn.innerHTML = `<i class="fas fa-spinner fa-spin"></i> ÈÅäÊà≤ËºâÂÖ•‰∏≠ (${percent}%)`;
                if (loadedCount >= assetKeys.length) { dom.startBtn.innerHTML = "ÈñãÂßãÁáüÊ•≠"; dom.startBtn.disabled = false; dom.startBtn.style.opacity = "1"; }
            };
            assetKeys.forEach(key => {
                const img = new Image();
                img.onload = checkProgress; img.onerror = checkProgress; img.src = ASSETS[key];
            });
            dom.bgm.load();
        };

        function startGame() { document.getElementById('intro-overlay').style.display = 'none'; render(); if(isMusicOn){ dom.bgm.volume = 0; dom.bgm.play().catch(e=>{}); } }

        function render() {
            const scene = SCRIPT[index];
            if (!scene) return;

            if (scene.type === "scene") {
                dom.bg.style.backgroundImage = `url('${ASSETS[scene.bg]}')`;
                dom.hudTime.innerText = scene.time;
                dom.char1.classList.remove('char-visible'); dom.char2.classList.remove('char-visible');
                index++; render(); return;
            }

            if (scene.type === "end") { showReport(); return; }

            if (scene.type === "key_search") {
                dom.overlay.style.display = 'none';
                dom.speakerName.innerText = "Á≥ªÁµ±ÊèêÁ§∫";
                typeWriter("Ë´ãÂú®Áï´Èù¢‰∏äÂ∞ãÊâæÈë∞Âåô...", dom.text);
                dom.key.style.display = 'block';
                dom.key.onclick = () => {
                    dom.key.style.display = 'none';
                    dom.speakerName.innerText = "Â∫óÈï∑";
                    typeWriter(scene.text, dom.text, () => {
                        speak(scene.text, "Â∫óÈï∑");
                        setTimeout(() => { index++; render(); }, 2000);
                    });
                };
                return;
            }

            updateCharacter(scene);

            if (scene.type === 'choice') showChoice(scene);
            else if (scene.type === 'date_input') showDateInput(scene);
            else if (scene.type === 'number_input') showNumberInput(scene);
            else if (scene.type === 'time_picker') showTimePicker(scene); 
            else showTalk(scene);
        }

        function updateCharacter(scene) {
            const activeEl = activeCharIndex === 1 ? dom.char1 : dom.char2;
            const nextEl = activeCharIndex === 1 ? dom.char2 : dom.char1;
            if (scene.char && ASSETS[scene.char]) {
                const targetSrc = ASSETS[scene.char];
                if (!activeEl.src.includes(targetSrc) || !activeEl.classList.contains('char-visible')) {
                    nextEl.className = 'char-img';
                    if (scene.char === 'char_clock') nextEl.classList.add('calendar-pos');
                    else if (scene.char === 'char_phone') nextEl.classList.add('phone-pos');
                    else if (scene.object) nextEl.classList.add('object-mode');
                    nextEl.src = targetSrc;
                    nextEl.onload = () => { nextEl.classList.add('char-visible'); activeEl.classList.remove('char-visible'); activeCharIndex = activeCharIndex === 1 ? 2 : 1; };
                }
            } else { dom.char1.classList.remove('char-visible'); dom.char2.classList.remove('char-visible'); }
        }

        function typeWriter(t, el, cb) { 
            if (typeWriterTimer) clearInterval(typeWriterTimer); 
            el.innerText = ""; let i = 0; 
            typeWriterTimer = setInterval(() => { 
                el.innerText += t.charAt(i); i++; 
                if (i >= t.length) { clearInterval(typeWriterTimer); typeWriterTimer = null; if (cb) cb(); } 
            }, 30); 
        }

        function showTalk(scene) { dom.overlay.style.display = 'none'; dom.speakerName.innerText = scene.speaker || "ÊóÅÁôΩ"; typeWriter(scene.text, dom.text); speak(scene.text, scene.speaker || "ÊóÅÁôΩ"); }

        function showChoice(scene) {
            dom.overlay.style.display = 'flex'; dom.titleText.innerText = scene.text; dom.content.innerHTML = "";
            speak(scene.text, "ÊóÅÁôΩ"); 
            scene.choices.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'choice-btn';
                btn.innerHTML = `<span>${opt.t}</span> <i class="fas fa-chevron-right"></i>`;
                btn.onclick = () => processResult({ s: opt.s, money: opt.money, reaction: opt.reaction }, opt.key);
                dom.content.appendChild(btn);
            });
        }

        function showDateInput(scene) {
            dom.overlay.style.display = 'flex'; dom.titleText.innerText = scene.text; speak(scene.text, "ÊóÅÁôΩ"); 
            dom.content.innerHTML = `<div class="input-group">
                <select id="yy_sel" class="custom-select"><option value="">Âπ¥‰ªΩ</option></select>
                <select id="mm_sel" class="custom-select"><option value="">Êúà‰ªΩ</option></select>
                <select id="dd_sel" class="custom-select"><option value="">Êó•Êúü</option></select>
            </div><button class="confirm-btn" onclick="checkDateHandler()">Á¢∫Ë™ç</button>`;
            const yy = document.getElementById('yy_sel'), mm = document.getElementById('mm_sel'), dd = document.getElementById('dd_sel');
            const now = new Date();
            for(let yr=now.getFullYear()-1; yr<=now.getFullYear()+1; yr++) yy.innerHTML += `<option value="${yr}">${yr-1911} Âπ¥</option>`;
            for(let i=1; i<=12; i++) mm.innerHTML += `<option value="${i-1}">${i} Êúà</option>`;
            for(let i=1; i<=31; i++) dd.innerHTML += `<option value="${i}">${i} Êó•</option>`;
            window.checkDateHandler = () => {
                const sY = parseInt(document.getElementById('yy_sel').value);
                const sM = parseInt(document.getElementById('mm_sel').value);
                const sD = parseInt(document.getElementById('dd_sel').value);
                if(isNaN(sY) || isNaN(sM) || isNaN(sD)) return;
                handleResult((sY === now.getFullYear() && sM === now.getMonth() && sD === now.getDate()), scene);
            };
        }

        function showNumberInput(scene) {
            dom.overlay.style.display = 'flex'; dom.titleText.innerText = scene.text; speak(scene.text, "ÊóÅÁôΩ"); 
            dom.content.innerHTML = `<div id="numpad-display"></div><div id="numpad">
                ${[1,2,3,4,5,6,7,8,9].map(n => `<button class="num-btn" onclick="addNum(${n})">${n}</button>`).join('')}
                <button class="num-btn" style="color:#fc8181" onclick="clearNum()">C</button>
                <button class="num-btn" onclick="addNum(0)">0</button>
                <button class="num-btn del-btn" onclick="backspace()"><i class="fas fa-backspace"></i></button>
                <button class="num-btn ok-btn" style="grid-column: span 3; background:#48bb78; color:white; font-size:20px; margin-top:10px;" onclick="checkNum()">Á¢∫Ë™çÈÄÅÂá∫</button>
            </div>`;
            let val = ""; const display = document.getElementById('numpad-display');
            window.addNum = (n) => { if (val === "" && n === 0) return; if(val.length<5) val+=n; display.innerText = val; };
            window.clearNum = () => { val=""; display.innerText = ""; };
            window.backspace = () => { val = val.slice(0, -1); display.innerText = val; };
            window.checkNum = () => { if(val==="") return; handleResult(parseInt(val) === scene.answer, scene); };
        }

        function showTimePicker(scene) {
            dom.overlay.style.display = 'flex'; dom.titleText.innerText = scene.text; speak(scene.text, "ÊóÅÁôΩ"); 
            dom.content.innerHTML = `<div class="time-picker-container"><div class="ampm-toggle">
                <button class="ampm-btn active" id="btn-am" onclick="setAmPm('AM')">‰∏äÂçà</button>
                <button class="ampm-btn" id="btn-pm" onclick="setAmPm('PM')">‰∏ãÂçà</button>
            </div><div class="hour-selector">${[1,2,3,4,5,6,7,8,9,10,11,12].map(h => `<div class="hour-btn" onclick="selectHour(${h}, this)">${h}</div>`).join('')}</div></div><button class="confirm-btn" onclick="checkTimePicker()">Á¢∫Ë™ç</button>`;
            let selectedPeriod = 'AM', selectedHour = null;
            window.setAmPm = (p) => { selectedPeriod = p; document.getElementById('btn-am').className = p==='AM' ? 'ampm-btn active' : 'ampm-btn'; document.getElementById('btn-pm').className = p==='PM' ? 'ampm-btn active' : 'ampm-btn'; };
            window.selectHour = (h, el) => { selectedHour = h; document.querySelectorAll('.hour-btn').forEach(b => b.classList.remove('selected')); el.classList.add('selected'); };
            window.checkTimePicker = () => { if(selectedHour === null) return; let finalH = selectedHour; if(selectedPeriod === 'PM' && selectedHour !== 12) finalH += 12; if(selectedPeriod === 'AM' && selectedHour === 12) finalH = 0; handleResult(finalH === 16, scene); };
        }

        function handleResult(isCorrect, scene) { processResult(isCorrect ? scene.correct : scene.wrong, false); }

        function processResult(data, isKeyTask) {
            riskScore += (data.s || 0); totalMoney += (data.money || 0); dom.hudMoney.innerText = totalMoney; dom.overlay.style.display = 'none'; 
            if (data.reaction) {
                blockAdvance = true; // ÈéñÂÆöÈªûÊìäÔºåÈò≤Ê≠¢ advanceStory ÂêåÊôÇËß∏Áôº
                dom.speakerName.innerText = data.reaction.speaker; dom.dialog.style.display = 'flex'; 
                typeWriter(data.reaction.text, dom.text, () => waitForClick()); speak(data.reaction.text, data.reaction.speaker); 
            } else {
                index++;
                if (SCRIPT[index] && SCRIPT[index].type === 'key_search' && !isKeyTask) index++;
                render();
            }
        }

        function advanceStory() {
            if (dom.overlay.style.display === 'flex' || dom.key.style.display === 'block' || blockAdvance) return;
            if (typeWriterTimer) { clearInterval(typeWriterTimer); typeWriterTimer = null; dom.text.innerText = SCRIPT[index].text || ""; return; }
            index++; if (index < SCRIPT.length) render();
        }

        function waitForClick() { 
            const h = () => { 
                dom.dialog.removeEventListener('click', h); 
                blockAdvance = false; // Ëß£Èô§ÈéñÂÆö
                index++; render(); 
            }; 
            setTimeout(() => dom.dialog.addEventListener('click', h), 500); 
        }

        function resizeApp() { document.getElementById('mobile-container').style.height = `${window.innerHeight}px`; }
        window.addEventListener('resize', resizeApp);

        function showReport() {
            document.getElementById('report-overlay').style.display = 'flex';
            document.getElementById('report-money').innerText = `$${totalMoney}`;
            const stamp = document.getElementById('final-stamp');
            const advice = document.getElementById('report-advice');
            let rankText = "", adviceContent = "";
            if (riskScore <= 1) { rankText = "ÈáëÁâåÂ∫óÈï∑"; adviceContent = "Â§™Âé≤ÂÆ≥‰∫ÜÔºÅÊÇ®ÁöÑË®òÊÜ∂ÂäõËàáÂà§Êñ∑ÂäõÈÉΩÈùûÂ∏∏Ê∏ÖÊô∞ÔºåË´ãÁπºÁ∫å‰øùÊåÅÔºÅ"; } 
            else if (riskScore <= 3) { rankText = "ÈäÄÁâåÂ∫óÈï∑"; adviceContent = "Ë°®Áèæ‰∏çÈåØÂñîÔºÅÂ§öÂãïËÖ¶„ÄÅÂ§öÈÅãÂãïÂèØ‰ª•ËÆìÈ†≠ËÖ¶Êõ¥ÈùàÊ¥ª„ÄÇ"; } 
            else { rankText = "ÈäÖÁâåÂ∫óÈï∑"; adviceContent = "ÊúÄËøëÊòØ‰∏çÊòØÊØîËºÉÁ¥ØÂë¢ÔºüÂª∫Ë≠∞ÊâæÊôÇÈñìÊâæÈÜ´ÁîüÊ™¢Êü•‰∏Ä‰∏ãÂñîÔºå‰øùÈ§ä‰∏Ä‰∏ãÂ§ßËÖ¶„ÄÇ"; }
            stamp.innerText = rankText; advice.innerText = adviceContent;
            speak("‰ªäÊó•ÁáüÊ•≠ÁµêÊùü„ÄÇÊÇ®ÁöÑË©ïÁ¥öÊòØÔºö" + rankText + "„ÄÇ" + adviceContent, "ÊóÅÁôΩ");
        }
    </script>
</body>
>>>>>>> d48b9ee (update:ÂÑ™ÂåñÊõ¥Êñ∞)
</html>